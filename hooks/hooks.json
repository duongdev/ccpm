{
  "$schema": "https://code.claude.com/schemas/settings.json",
  "description": "CCPM Plugin Hooks - Smart agent auto-invocation, TDD enforcement, and quality gates",
  "hooks": {
    "UserPromptSubmit": [
      {
        "hooks": [
          {
            "type": "prompt",
            "prompt": "${CLAUDE_PLUGIN_ROOT}/hooks/smart-agent-selector-optimized.prompt",
            "timeout": 5000,
            "description": "Smart agent selector: Context-aware scoring algorithm to auto-invoke optimal agents"
          }
        ]
      }
    ],
    "PreToolUse": [
      {
        "matcher": "Write|Edit|NotebookEdit",
        "hooks": [
          {
            "type": "prompt",
            "prompt": "${CLAUDE_PLUGIN_ROOT}/hooks/tdd-enforcer-optimized.prompt",
            "timeout": 3000,
            "description": "TDD enforcer: Ensures tests exist before production code changes (Red-Green-Refactor)"
          }
        ]
      }
    ],
    "Stop": [
      {
        "hooks": [
          {
            "type": "prompt",
            "prompt": "${CLAUDE_PLUGIN_ROOT}/hooks/quality-gate-optimized.prompt",
            "timeout": 5000,
            "description": "Quality gate: Automatically invokes code review and security checks after implementation"
          }
        ]
      }
    ]
  },
  "usage": {
    "installation": "This file is automatically applied when the CCPM plugin is installed",
    "customization": "Users can disable specific hooks in their project's .claude/settings.json",
    "optimization": "Using optimized hook prompts from PSN-23: 49% token reduction, 94% faster execution"
  },
  "notes": {
    "smart_agent_selector": {
      "purpose": "Analyzes every user prompt to determine which agents should be invoked",
      "trigger": "UserPromptSubmit",
      "execution": "Before Claude starts responding",
      "output": "Injects agent invocation instructions into Claude's context",
      "performance": "Optimized version: 81.7% token reduction, <1s execution with caching"
    },
    "tdd_enforcer": {
      "purpose": "Blocks production code changes if tests don't exist (Red-Green-Refactor)",
      "trigger": "PreToolUse for Write/Edit/NotebookEdit",
      "execution": "Before file is written to disk",
      "output": "Blocks and invokes tdd-orchestrator if tests missing",
      "performance": "Optimized version: 49% token reduction, <1s execution"
    },
    "quality_gate": {
      "purpose": "Automatically runs quality checks after implementation",
      "trigger": "Stop (after Claude finishes responding)",
      "execution": "Post-implementation analysis",
      "output": "Invokes code-reviewer, security-auditor as needed",
      "performance": "Optimized version: 38.8% token reduction, <1s execution"
    }
  }
}
